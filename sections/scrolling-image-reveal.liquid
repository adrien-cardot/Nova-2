{% capture capture_clip %}
	{{ 'component-zoom-gallery.css' | asset_url | stylesheet_tag }}
	<x-zoom-gallery class="zoom-gallery" style="--zoom-gallery-items-count: {{ section.blocks.size }};">
		<div class="zoom-gallery__bg">
			<div class="zoom-gallery__bg-inner">
				{% for block in section.blocks -%}
					{%- assign block_video = blank -%}
					{%- assign block_image = blank -%}
					{%- if block.type == 'image' -%}
						{%- assign block_image = block.settings.image -%}
					{%- elsif block.type == 'video' -%}
						{%- assign block_video = block.settings.video -%}
					{%- endif %}
					<div
						class="zoom-gallery__bg-item color-scheme-{{ block.settings.color_scheme.id }}"
						style="--zoom-gallery-bg-item-index: {{ forloop.index0 }};"
					>
						{% if block_image != blank %}
							<picture class="zoom-gallery__bg-item__image">
								<source srcset="{{ block_image | image_url: width: 50 }} 1x, {{ block_image | image_url: width: 100 }} 2x, {{ block_image | image_url: width: 150 }} 3x">

								<img
									src="{{ block_image | image_url }}"
									alt="{{ block_image.alt | escape }}"
									width="{{ block_image.width }}"
									height="{{ block_image.height }}"
									loading="lazy"
									data-img-loading
									onload="this.removeAttribute(&#34;data-img-loading&#34;)"
								>
							</picture>
						{%- elsif block_video != blank %}
							<picture class="zoom-gallery__bg-item__image">
								<source srcset="{{ block_video.preview_image | image_url: width: 50 }} 1x, {{ block_video.preview_image | image_url: width: 100 }} 2x, {{ block_video.preview_image | image_url: width: 150 }} 3x">

								<img
									src="{{ block_video.preview_image | image_url }}"
									alt="{{ block_video.preview_image.alt | escape }}"
									width="{{ block_video.preview_image.width }}"
									height="{{ block_video.preview_image.height }}"
									loading="lazy"
									data-img-loading
									onload="this.removeAttribute(&#34;data-img-loading&#34;)"
								>
							</picture>
						{%- else %}
							{{
								forloop.index0
								| modulo: 6
								| plus: 1
								| prepend: '-'
								| prepend: 'collection'
								| placeholder_svg_tag: 'zoom-gallery__bg-item__placeholder'
							-}}
						{%- endif %}
					</div>
				{% endfor %}
			</div>
		</div>
		<div class="zoom-gallery__stage">
			<div class="zoom-gallery__text">
				<div class="container">
					<div class="content content--align--center content--compact-text color-scheme-{{ section.settings.color_scheme.id }}">
						{% if section.settings.heading_text != blank %}
							<div class="content__heading">
								{% capture heading_capture %}
									<h2 class="heading heading--size--{{ section.settings.heading_size }}">
										{{ section.settings.heading_text }}
									</h2>
								{% endcapture %}
								{% if section.settings.heading_animation %}
									<div
										class="scroll-animation scroll-animation--use--text-reveal scroll-animation--origin-align--center {% unless settings.appearance_animate_heading_on_mobile %}scroll-animation--only-desktop-animation{% endunless %}"
										style=""
									>
										{{ heading_capture }}
									</div>
								{% else -%}
									{{- heading_capture -}}
								{%- endif %}
							</div>
						{% endif -%}
						{%- if section.settings.description != blank %}
							<div class="content__text">
								<p class="text text--size--md">{{ section.settings.description }}</p>
							</div>
						{% endif %}
					</div>
				</div>
			</div>
			{% for block in section.blocks -%}
				{%- assign block_video = blank -%}
				{%- assign block_image = blank -%}
				{%- if block.type == 'image' -%}
					{%- assign block_image = block.settings.image -%}
				{%- elsif block.type == 'video' -%}
					{%- assign block_video = block.settings.video -%}
				{%- endif -%}
				{%- assign mod2 = forloop.index0 | modulo: 2 -%}
				{%- if mod2 == 0 %}{% assign is_right_image = false %}{% else %}{% assign is_right_image = true %}{% endif %}

				{% capture capture_image %}
					<div class="zoom-gallery__item__image">
						<div
							class="banner banner--size--{{ block.settings.image_ratio }}"
							style="--banner-placeholder-ar: 1/1;--banner-focal: {{ block_image.presentation.focal_point }};"
						>
							{% if block_video != blank -%}
								<x-bg-video class="bg-video">
									<video
										class="banner__video"
										loop
										muted
										preload="none"
										width="{{ block_video.sources.first.width }}"
										height="{{ block_video.sources.first.height }}"
										data-bg-video-element="video"
									>
										{% for source in block_video.sources %}
											<source src="{{ source.url }}" type="{{ source.mime_type }}">
										{% endfor %}
									</video>
								</x-bg-video>
								<script type="module" src="{{ 'component-bg-video.js' | asset_url }}"></script>
							{% endif %}
							{% if block_image != blank %}
								<picture class="banner__image">
									<source
										srcset="
											{% if block_image.width >= 375 %}{{ block_image | image_url: width: 375 }} 375w,{% endif %}
											{% if block_image.width >= 550 %}{{ block_image | image_url: width: 550 }} 550w,{% endif %}
											{% if block_image.width >= 750 %}{{ block_image | image_url: width: 750 }} 750w,{% endif %}
											{% if block_image.width >= 1100 %}{{ block_image | image_url: width: 1100 }} 1100w,{% endif %}
											{% if block_image.width >= 1500 %}{{ block_image | image_url: width: 1500 }} 1500w,{% endif %}
											{% if block_image.width >= 1780 %}{{ block_image | image_url: width: 1780 }} 1780w,{% endif %}
											{% if block_image.width >= 2000 %}{{ block_image | image_url: width: 2000 }} 2000w,{% endif %}
											{{ block_image | image_url }} {{ block_image.width }}w
										"
										sizes="(min-width: 992px) 50vw, (max-width: 992px) 75vw"
									>

									<img
										src="{{ block_image | image_url }}"
										alt="{{ block_image.alt | escape }}"
										width="{{ block_image.width }}"
										height="{{ block_image.height }}"
										loading="lazy"
										data-img-loading
										onload="this.removeAttribute(&#34;data-img-loading&#34;)"
									>
								</picture>
							{%- endif %}

							{% if block_video == blank and block_image == blank %}
								{{
									forloop.index0
									| modulo: 6
									| plus: 1
									| prepend: '-'
									| prepend: 'collection'
									| placeholder_svg_tag: 'banner__placeholder'
								-}}
							{%- endif %}
						</div>
					</div>
				{% endcapture %}

				{% capture capture_caption %}
					<div class="zoom-gallery__item__image-caption">
						<div class="content content--align--center content--spacing--sm">
							{% if block.settings.subheading_text != blank %}
								<div class="content__subheading">
									<p class="subheading">
										{{ block.settings.subheading_text }}
									</p>
								</div>
							{% endif -%}
							{%- if block.settings.heading_text != blank %}
								<div class="content__heading">
									<h2 class="heading heading--size--{{ block.settings.heading_size }}">
										{{ block.settings.heading_text }}
									</h2>
								</div>
							{% endif -%}
							{%- if block.settings.text_content != blank %}
								<div class="content__text">
									<p class="text text--size--md">{{ block.settings.text_content }}</p>
								</div>
							{% endif %}
						</div>
					</div>
				{% endcapture %}

				<div
					class="zoom-gallery__item {% if is_right_image %}zoom-gallery__item--is-right{% endif %}"
					style="--zoom-gallery-item-index: {{ forloop.index0 | divided_by: 2 | floor }};"
					data-scroll-item="{{ forloop.index0 }}"
					{{ block.shopify_attributes }}
				>
					<div class="zoom-gallery__item__container color-scheme-{{ block.settings.color_scheme.id }}">
						{% capture capture_link_content -%}
							{%- if section.settings.gyro_effect %}
								<x-mouse-tracker class="mouse-tracker mouse-tracker--outer" style="">
									<div class="mouse-tracker__stage mouse-tracker__stage--outer">
										<div class="mouse-tracker__stage__inner">
											{{ capture_image }}
										</div>

										<div class="mouse-tracker__shadow"></div>
									</div>
									<div class="mouse-tracker__border"></div>

									<div class="mouse-tracker__caption">
										<div class="mouse-tracker__caption__content">
											{{ capture_caption }}
										</div>
									</div>
								</x-mouse-tracker>
							{% else -%}
								{{- capture_image -}}
								{{- capture_caption -}}
							{%- endif -%}
						{%- endcapture -%}
						{%- if block.settings.link != blank -%}
							<a class="block-link" href="{{ block.settings.link }}">
								{{ capture_link_content }}
							</a>
						{%- else -%}
							{{- capture_link_content -}}
						{%- endif %}
					</div>
				</div>
			{% endfor %}
		</div>
	</x-zoom-gallery>
	<script type="module" src="{{ 'component-zoom-gallery.js' | asset_url }}"></script>
{% endcapture %}
{% if section.settings.scroll_clip %}
	<div
		class="scroll-animation scroll-animation--use--{% if section.index0 == 0 %}clip-out{% else %}clip-in{% endif %}"
		style=""
	>
		{{ capture_clip }}
	</div>
{% else -%}
	{{- capture_clip -}}
{%- endif %}

{% schema %}
	{
		"name": "Scrolling image reveal",
		"class": "scrolling-image-reveal-section",
		"presets": [
			{
				"name": "Scrolling image reveal",
				"blocks": [
					{
						"type": "image"
					},
					{
						"type": "image"
					},
					{
						"type": "image"
					},
					{
						"type": "image"
					}
				],
				"category": "Media"
			}
		],
		"disabled_on": {
			"templates": ["password"],
			"groups": ["header", "custom.overlay"]
		},
		"settings": [
			{
				"type": "text",
				"id": "heading_text",
				"label": "Heading",
				"default": "Heading"
			},
			{
				"type": "checkbox",
				"id": "heading_animation",
				"label": "Use heading animation",
				"default": true
			},
			{
				"type": "select",
				"id": "heading_size",
				"label": "Heading size",
				"default": "d3",
				"options": [
					{
						"value": "h1",
						"label": "Small"
					},
					{
						"value": "d3",
						"label": "Medium"
					},
					{
						"value": "d2",
						"label": "Large"
					}
				]
			},
			{
				"type": "color_scheme",
				"id": "color_scheme",
				"label": "Heading color scheme",
				"default": "invert"
			},
			{
				"type": "inline_richtext",
				"id": "description",
				"label": "Text",
				"default": "Share information about your brand with your customers. Describe a product, make announcements, or welcome customers to your store."
			},
			{
				"type": "checkbox",
				"id": "gyro_effect",
				"label": "Enable 3D effect on mouseover",
				"default": true
			},
			{
				"type": "checkbox",
				"id": "scroll_clip",
				"label": "Enable clip effect on scroll"
			}
		],
		"blocks": [
			{
				"name": "Image",
				"type": "image",
				"settings": [
					{
						"type": "image_picker",
						"id": "image",
						"label": "Image"
					},
					{
						"type": "select",
						"id": "image_ratio",
						"label": "Aspect ratio",
						"options": [
							{
								"value": "auto",
								"label": "Original"
							},
							{
								"value": "square",
								"label": "Square (1:1)"
							},
							{
								"value": "landscape",
								"label": "Landscape (4:3)"
							},
							{
								"value": "portrait",
								"label": "Portrait (2:3)"
							}
						],
						"default": "auto"
					},
					{
						"type": "url",
						"id": "link",
						"label": "Link"
					},
					{
						"type": "text",
						"id": "subheading_text",
						"label": "Subheading"
					},
					{
						"type": "text",
						"id": "heading_text",
						"label": "Heading",
						"default": "Banner heading"
					},
					{
						"type": "select",
						"id": "heading_size",
						"label": "Heading size",
						"default": "h4",
						"options": [
							{
								"value": "h5",
								"label": "Small"
							},
							{
								"value": "h4",
								"label": "Medium"
							},
							{
								"value": "h3",
								"label": "Large"
							}
						]
					},
					{
						"type": "inline_richtext",
						"id": "text_content",
						"label": "Text",
						"default": "Describe a product, make announcements, or welcome customers to your store."
					},
					{
						"type": "color_scheme",
						"id": "color_scheme",
						"label": "Color scheme",
						"default": "invert"
					}
				]
			},
			{
				"name": "Video",
				"type": "video",
				"settings": [
					{
						"type": "video",
						"id": "video",
						"label": "Video"
					},
					{
						"type": "select",
						"id": "image_ratio",
						"label": "Video aspect ratio",
						"options": [
							{
								"value": "auto",
								"label": "Original"
							},
							{
								"value": "square",
								"label": "Square (1:1)"
							},
							{
								"value": "landscape",
								"label": "Landscape (4:3)"
							},
							{
								"value": "portrait",
								"label": "Portrait (2:3)"
							}
						],
						"default": "auto"
					},
					{
						"type": "url",
						"id": "link",
						"label": "Link"
					},
					{
						"type": "text",
						"id": "subheading_text",
						"label": "Subheading"
					},
					{
						"type": "text",
						"id": "heading_text",
						"label": "Heading",
						"default": "Banner heading"
					},
					{
						"type": "select",
						"id": "heading_size",
						"label": "Heading size",
						"default": "h4",
						"options": [
							{
								"value": "h5",
								"label": "Small"
							},
							{
								"value": "h4",
								"label": "Medium"
							},
							{
								"value": "h3",
								"label": "Large"
							}
						]
					},
					{
						"type": "inline_richtext",
						"id": "text_content",
						"label": "Text",
						"default": "Describe a product, make announcements, or welcome customers to your store."
					},
					{
						"type": "color_scheme",
						"id": "color_scheme",
						"label": "Color scheme",
						"default": "invert"
					}
				]
			}
		]
	}
{% endschema %}
